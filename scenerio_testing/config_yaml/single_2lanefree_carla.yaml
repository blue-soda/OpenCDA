# This is the scenario testing configuration file for single vehicle testing

# First define the basic parameters of the vehicles
vehicle_base: &vehicle_base
  sensing: &base_sensing # perception realted
    activate: false
  behavior: &base_behavior # behavior related
    max_speed: 111 # maximum speed, km/h
    tailgate_speed: 121 # when a vehicles needs to be close to another vehicle asap
    speed_lim_dist: 3 # max_speed - speed_lim_dist = target speed
    speed_decrease: 15 # used in car following mode to decrease speed for distance keeping
    safety_time: 4 # ttc safety thresholding for decreasing speed
    emergency_param: 0.4 # used to identify whether a emergency stop needed
    ignore_traffic_light: true # whether to ignore traffic light
    overtake_allowed: false # whether overtake allowed, typically false for platoon leader
    collision_time_ahead: 1.1 # used for collision checking
    overtake_counter_recover: 35 # used to avoid successive overtaking
    sample_resolution: 4.5 # the unit distance between two adjacent waypoints in meter
    local_planner: &base_local_planner # trajectory planning related
      buffer_size: 12 # waypoint buffer size
      trajectory_update_freq: 15 # used to control trajectory points updating frequency
      waypoint_update_freq: 12 # used to control waypoint updating frequency
      min_dist: 3 # used to pop out the waypoints too close to current location
      debug: false # whether to draw future/history waypoints
      debug_trajectory: false # whether to draw the trajectory points and path
  controller: &base_controller # control related
    type: pid
    args:
      lat:
        k_p: 0.75
        k_d: 0.02
        k_i: 0.4
        dt: 0.05 # this should be equal to your simulation time-step
      lon:
        k_p: 0.37
        k_d: 0.024
        k_i: 0.032
        dt: 0.05 # this should be equal to your simulation time-step
      dynamic: true # whether use dynamic pid setting
  v2x: &base_v2x # comminuation related
    enabled: true
    communication_range: 35

# define carla simulation setting
world:
  sync_mode: true
  client_port: 2000
  fixed_delta_seconds: 0.05

# define scenario. In this scenario, a 4-vehicle platoon already exists.
scenario:
  single_cav_list: # this is for merging vehicle or single cav without v2x
    - <<: *vehicle_base
      spawn_position: [-320, 7.5, 0.3]
      destination: [300, 10.5, 0.3]
      v2x:
        <<: *base_v2x
        communication_range: 45
      behavior:
        <<: *base_behavior
        local_planner:
          <<: *base_local_planner
          debug_trajectory: true
          debug: true


